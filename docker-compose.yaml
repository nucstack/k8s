version: "3.4"
services:
  builder:
    environment:
      HISTFILE: /bash_history/.bash_history
    image: builder:latest
    network_mode: host
    build:
      context: ./docker/builder
    working_dir: /app
    volumes:
      - .:/app:rw
      - bashhistory:/bash_history
      - ~/.gnupg:/root/.gnupg

  # custom image for rtlamr-collect
  rtlamr-collect:
    image: ${PRIVATE_REGISTRY}/rtlamr-collect:0.0.5
    build:
      context: ./docker/rtlamr-collect

  # custom image for rsyslog
  rsyslog:
    image: ${PRIVATE_REGISTRY}/rsyslog:0.0.1
    build:
      context: ./docker/rsyslog

volumes:
  # useful to maintain history
  bashhistory: